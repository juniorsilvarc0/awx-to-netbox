- name: Executar sincronizacao AWX para NetBox
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Executar o script de sincronizacao (awx-netbox.py)
      ansible.builtin.command:
        cmd: python3 -u scripts/awx-netbox.py
        chdir: /runner/project
      register: script_result
      failed_when: script_result.rc != 0

    - name: Mostrar resultado da execucao
      ansible.builtin.debug:
        msg:
          - "Status: {{ 'Sucesso' if script_result.rc == 0 else 'Falha' }}"
          - "Return Code: {{ script_result.rc }}"
          - "Saida (STDOUT):"
          - "{{ script_result.stdout }}"
          - "Erros (STDERR):"
          - "{{ script_result.stderr }}"
      always: true